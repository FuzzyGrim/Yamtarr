{% block content %}

<!DOCTYPE html>
<html lang="en">

  <head>
    {% include "app/include/tags.html" %}
    <title>Yamtarr</title>
  </head>

  <body id="search">

    {% include "app/include/navbar.html" %}    

    <main>
        {% if messages %}
            {% for message in messages %}
            {% if message.tags == 'error' %}
                <div class="alert alert-danger">
            {% else %}
                <div class="alert alert-{{ message.tags }}">
            {% endif %}
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}
        {% for query in query_list %}
            <div class="d-flex flex-column box">
                <div class="d-flex flex-row">
                    
                    {% if query.node.main_picture.large == None %}
                        <div class="image-not-found poster flex-shrink-0">
                        </div>
                    {% else %}
                        <img class="poster flex-shrink-0" src={{query.node.main_picture.large}}>
                    {% endif %}

                    <div class="d-flex flex-column content flex-grow-1">
                        <div class="title">
                            {{query.node.title}} 
                            {% if query.node.start_date %} ({{query.node.start_date|slice:"4"}}) {% endif %}
                            {% if query.node.media_type == "light_novel" %} [Light Novel]
                            {% elif query.node.media_type == "ova" %} [OVA]
                            {% else %} [{{query.node.media_type|capfirst}}]
                            {% endif %}
                        </div>

                        <div class="overview">
                            {% if query.node.synopsis %} {{query.node.synopsis}} 
                            {% else %} No synopsis available. 
                            {% endif %}
                        </div>

                        <form class="d-flex input-group" method="post">
                            {% csrf_token %}

                            <select name="status" class="form-select">
                                <option value="Completed">Completed</option>
                                <option value="Planning">Planning</option>
                                <option value="Watching">Watching</option>
                                <option value="Paused">Paused</option>
                                <option value="Dropped">Dropped</option>
                            </select>
                            <input type="number" class="form-control bg-dark text-white" name="score" placeholder="0" aria-label="10" maxlength="3" step="0.1" min="0" max="10">
                            

                            <input type="hidden" name="title" value="{{query.node.title}}">
                            <input type="hidden" name="media_type" value="{{query.node.media_type}}">
                            <input type="hidden" name="media_id" value="{{ query.node.id }}">
                            <input type="hidden" name="image" value="{{ query.node.main_picture.large }}">
                            <input type="hidden" name="api_origin" value="mal">
                            
                            <button class="btn bg-dark text-white" type="submit"><i class="bi bi-check-lg"></i></button>
                        </form>
                    </div>
                </div>
            </div>

        {% endfor %}

    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>

    </body>

</html>
{% endblock %}